\section{Approximation Methods for Stationary States in Quantum Mechanics}

Solving a general quantum mechanical problem involves finding the Hamiltonian of a system and solving the Schrödinger Equation to find energies and states. However, most problems encountered in quantum mechanics cannot be solved exactly. Exact solutions of the Schrödinger equation exist only for a few idealized systems\footnote{For example, for the \textit{quantum harmonic oscillator}, the \textit{quantum anharmonic oscillator}, the \textit{infinite square well}, the \textit{free particle}, and the \textit{hydrogen atom} can be solved exactly. However, the \textit{spin-orbital interactions}, the \textit{Zeeman effect} or the \textit{hyperfine split} cannot.}. To solve general problems, one must resort to approximation methods.

In this chapter we consider approximation methods that deal with \textit{stationary states} corresponding to \textit{time-independent} Hamiltonians. To study problems of stationary states, we focus on two approximation methods: \textbf{time-independent perturbation theory} and the \textbf{variational method}.

\subsection{Introduction to perturbation theory}

Perturbation theory provides a method to approximate energy eigenvalues and eigenstates of Hamiltonians of the form:
\begin{equation}
    H = H_0 + H_p
\end{equation}
where $H_0$ is the Hamiltonian of an exactly solvable system (unperturbed system) and $H_p$ is a small time-independent perturbation. In other words, perturbation theory enables us to obtain solutions for systems that are ``close'' to exactly solvable systems.

For a general (possibly degenerate\footnote{Degeneracy is indexed by $i$.}) case, the discrete eigenvalues and eigenstates of the unperturbed Hamiltonian can be defined as:
\begin{equation}
    H_0 \ket{{\psi_n^i}^{(0)}} = E_n^{(0)} \ket{{\psi_n^i}^{(0)}} 
\end{equation}
where the states are assumed to be orthonormal. We can also write the eigenvalue equation for the perturbed system:
\begin{equation}
    H \ket{\psi_n^i} = E_n\ket{\psi_n^i} 
\end{equation}
The idea is to determine the small corrections required so that $\ket{{\psi_n^i}^{(0)}}\to \ket{\psi_n^i}$ and $E_n^{(0)}\to E_n$. Of course, this can only be accomplished if $H_p$ is ``small enough'' (we will quantify this later) so that $\ket{{\psi_n^i}^{(0)}}$ are close to $\ket{\psi_n^i}$. It is common to write this using a dimensionless parameter $\lambda \ll 1$ so that:
\begin{equation}
    H_p = \lambda W
\end{equation}
Then, we can rewrite the perturbed Hamiltonian as:
\begin{equation}
    H = H_0 + \lambda W
\end{equation}

Depending on whether the unperturbed system has any degenerate eigenvalues or not, we have two different ways of treating the problem. We shall discuss both cases separately.

\subsection{Non-degenerate perturbation theory}


Let us assume that we have a system with an unperturbed and non-degenerate Hamiltonian $H_0$, the eigenvalue problem for which is solved and the spectrum of which is discrete:
\begin{equation}
    H_0 \ket{\psi_p^{(0)}} = E_p^0\ket{\psi_p^{(0)}}
\end{equation}
The eigenstates $\ket{\psi_p^{(0)}}$ form a complete orthonormal basis:
\begin{equation}
    \braket{\psi_n^{(0)}|\psi_p^{(0)}} = \delta_{np} \qquad \sum_p \ket{\psi_p^{(0)}}\bra{\psi_p^{(0)}} = \Imat
\end{equation}
We can also write the perturbed eigenproblem for the Hamiltonian $H(\lambda) = H_0 + \lambda W$ as:
\begin{equation}
    H(\lambda)\ket{\psi_n(\lambda)} = E_n(\lambda)\ket{\psi_n(\lambda)}
\end{equation}
The main idea of perturbation theory consists in now assuming that the perturbed eigenvalues and eigenstates can both be expanded in power series in the parameter $\lambda$:
\begin{equation} \label{expansions_pert}
    \begin{split}
        E_n(\lambda) &= E_n^{(0)} + \lambda E_n^{(1)} + \lambda^2 E_n^{(2)} + \cdots = \sum_{k=0}^\infty E_n^{(k)}\lambda^k\\
        \ket{\psi_n(\lambda)} &= \ket{\psi_n^{(0)}} + \lambda \ket{\psi_n^{(1)}} + \lambda^2\ket{\psi_n^{(2)}} + \cdots = \sum_{k=0}^\infty \ket{\psi_n^{(k)}}\lambda^k
    \end{split}
\end{equation}
The parameters $E_n^{(k)}$ and $\ket{\psi_n^{(k)}}$ are the $k$-th corrections to the eigenenergies and the eigenstates, respectively. We need to make two remarks here. First, one might think that, whenever the perturbation is sufficiently weak, the expansions in \textbf{Equation \ref{expansions_pert}} always exist. Unfortunately, this is not always the case. In some cases where the perturbation is small, $E_n(\lambda)$ and $\ket{\psi_n(\lambda)}$ are not expandable in powers of $\lambda$. Second, these series are frequently not convergent. However, when $\lambda$ is small, the first few terms do provide a reliable description of the system. So in practice, we keep only one or two terms in these expansions; hence the problem of nonconvergence of these series is avoided. Note that when $\lambda=0$, the expressions in \textbf{Equation \ref{expansions_pert}} yield the unperturbed solutions: $E_n = E n^{(0)}$ and $\ket{\psi_n} = \ket{\psi_n^{(0)}}$.

The job of perturbation theory then reduces to the calculation of $E_n^{(1)}$, $E_n^{(2)}$, $\cdots$ and $\ket{\psi_n^{(1)}}$, $\ket{\psi_n^{(2)}}$, $\cdots$. We shall only be concerned in this section with the determination of the first and second corrections to the energy, as well as the first correction to the eigenkets.

As we assumed that the unperturbed states were non-degenerate, we can write:
\begin{equation}
    \begin{split}
        E_n(\lambda)\ket{\psi_n(\lambda)} &= \left(E_n^{(0)} + \lambda E_n^{(1)} + \lambda^2 E_n^{(2)} + \cdots\right)\left(\ket{\psi_n^{(0)}} + \lambda \ket{\psi_n^{(1)}} + \lambda^2\ket{\psi_n^{(2)}} + \cdots\right) = \\
        &\begin{split}
            = E_n^{(0)}\ket{\psi_n^{(0)}} &+ \left[E_n^{(0)}\ket{\psi_n^{(1)}} + E_n^{(1)}\ket{\psi_n^{(0)}}\right] \lambda + \\ 
            &+ \left[E_n^{(0)}\ket{\psi_n^{(2)}} + E_n^{(1)}\ket{\psi_n^{(1)}} + E_n^{(2)}\ket{\psi_n^{(0)}}\right] \lambda^2 + \cdots =
        \end{split} \\
        &= E_n^{(0)}\ket{\psi_n^{(0)}} + \sum_{a=1}^\infty \left(\lambda^a\sum_{i=0}^a\sum_{j=0}^{a}E_n^{(i)}\ket{\psi_n^{(j)}}\delta_{i+j,a}\right)
    \end{split}
\end{equation}
\begin{equation}
    \begin{split}
        H(\lambda)\ket{\psi_n(\lambda)} &= \left(H_0+\lambda W\right)\left(\ket{\psi_n^{(0)}} + \lambda \ket{\psi_n^{(1)}} + \lambda^2\ket{\psi_n^{(2)}} + \cdots\right) = \\
        &= H_0\ket{\psi_n^{(0)}} + \left[H_0\ket{\psi_n^{(1)}} + W\ket{\psi_n^{(0)}}\right] \lambda + \left[H_0\ket{\psi_n^{(2)}} + W\ket{\psi_n^{(1)}}\right] \lambda^2 + \cdots =\\
        &= H_0\ket{\psi_n^{(0)}} + \sum_{a=1}^\infty \left(\lambda^a \left[H_0\ket{\psi_n^{(a)}} + W \ket{\psi_n^{(a-1)}}\right]\right)
    \end{split}
\end{equation}

Therefore, as $E_n(\lambda)\ket{\psi_n(\lambda)} = H(\lambda)\ket{\psi_n(\lambda)}$, we have:
\begin{equation}
    E_n^{(0)}\ket{\psi_n^{(0)}} + \sum_{a=1}^\infty \left(\lambda^a\sum_{i=0}^{a}\sum_{j=0}^{a}E_n^{(i)}\ket{\psi_n^{(j)}}\delta_{i+j,a}\right) = H_0\ket{\psi_n^{(0)}} + \sum_{a=1}^\infty \left(\lambda^a \left[H_0\ket{\psi_n^{(a)}} + W \ket{\psi_n^{(a-1)}}\right]\right)
\end{equation}

This gives us all the equations to solve in order to find the coefficients of the expansion:
\begin{itemize}
    \item Zero order\footnote{The zero order correction is trivial, as it is just the eigenvalue equation for the unperturbed system.} in $\lambda$:
    \begin{equation}
        H_0\ket{\psi_n^{(0)}} = E_n^{(0)}\ket{\psi_n^{(0)}}
    \end{equation}
    \item First order in $\lambda$:
    \begin{equation} \label{first_order_correction_eig_eqn}
        H_0\ket{\psi_n^{(1)}} + W\ket{\psi_n^{(0)}} = E_n^{(0)}\ket{\psi_n^{(1)}} + E_n^{(1)}\ket{\psi_n^{(0)}}
    \end{equation}
    \item Second order in $\lambda$:
    \begin{equation} \label{second_order_correction_eig_eqn}
        H_0\ket{\psi_n^{(2)}} + W\ket{\psi_n^{(1)}} = E_n^{(0)}\ket{\psi_n^{(2)}} + E_n^{(1)}\ket{\psi_n^{(1)}} + E_n^{(2)}\ket{\psi_n^{(0)}}
    \end{equation}
    $$
    \vdots
    $$
    \item $a$-th order in $\lambda$:
    \begin{equation}
        H_0\ket{\psi_n^{(a)}} + W \ket{\psi_n^{(a-1)}} = \sum_{i=0}^{a}\sum_{j=0}^{a}E_n^{(i)}\ket{\psi_n^{(j)}}\delta_{i+j,a}
    \end{equation}
\end{itemize} 

Note that, since $\ket{\psi_n^{(0)}}\simeq \ket{\psi_n(\lambda)}$, we can normalise $\ket{\psi_n(\lambda)}$ so that $\braket{\psi_n^{(0)}|\psi_n(\lambda)} = 1$. Then:
\begin{equation}
    1 = \braket{\psi_n^{(0)}|\psi_n(\lambda)} = \braket{\psi_n^{(0)}|\psi_n^{(0)}} + \lambda \braket{\psi_n^{(0)}|\psi_n^{(1)}} + \lambda^2\braket{\psi_n^{(0)}|\psi_n^{(2)}} + \cdots = 1 + \sum_{k=1}^\infty \braket{\psi_n^{(0)}|\psi_n^{(k)}}\lambda^k
\end{equation}
Therefore:
\begin{equation} \label{orthonormal_perturbation_terms}
    \sum_{k=1}^\infty \braket{\psi_n^{(0)}|\psi_n^{(k)}}\lambda^k = 0 \quad\longrightarrow\quad \braket{\psi_n^{(0)}|\psi_n^{(k)}} = 0,\quad \forall k = 1, 2, 3, ...
\end{equation}


\subsubsection{First order correction}

If we multiply both sides of \textbf{Equation \ref{first_order_correction_eig_eqn}} by $\bra{\psi_n^{(0)}}$, we find\footnote{Remember that $H_0$ is Hermitian, so it can be applied to its eigenstate $\psi_n^{(0)}$ on the left.}:
\begin{equation}
    \begin{split}
        &\braket{\psi_n^{(0)}|H_0|\psi_n^{(1)}} + \braket{\psi_n^{(0)}|W|\psi_n^{(0)}} = \braket{\psi_n^{(0)}|E_n^{(0)}|\psi_n^{(1)}} + \braket{\psi_n^{(0)}|E_n^{(1)}|\psi_n^{(0)}}\\
        &\longrightarrow \cancelto{\ 0}{E_n^{(0)}\braket{\psi_n^{(0)}|\psi_n^{(1)}}} + \braket{\psi_n^{(0)}|W|\psi_n^{(0)}} = \cancelto{\ 0}{E_n^{(0)}\braket{\psi_n^{(0)}|\psi_n^{(1)}}} + E_n^{(1)}\cancelto{\ 1}{\braket{\psi_n^{(0)}|\psi_n^{(0)}}} \\
        &\longrightarrow \braket{\psi_n^{(0)}|W|\psi_n^{(0)}} = E_n^{(1)}
    \end{split}
\end{equation}

Therefore:
\begin{equation}
    E_n^{(1)} = \braket{\psi_n^{(0)}|W|\psi_n^{(0)}}
\end{equation}
This energy shift must be small compared to the level spacing in the unperturbed system. Note that, for some systems, the first order correction $E_n^{(1)}$ vanishes exactly. In such cases, one needs to consider higher order terms. We will later discuss the second order correction.

In order to determine the first order correction to the eigenstates, we can take advantage of the fact that the unperturbed states form a complete orthonormal basis:
\begin{equation}
    \ket{\psi_n^{(1)}} = \left(\sum_m \ket{\psi_m^{(0)}}\bra{\psi_m^{(0)}}\right)\ket{\psi_n^{(1)}} = \sum_m \braket{\psi_m^{(0)}|\psi_n^{(1)}}\ket{\psi_m^{(0)}} = \sum_{m\neq n} \braket{\psi_m^{(0)}|\psi_n^{(1)}}\ket{\psi_m^{(0)}}
\end{equation}
Note that the term $m = n$ does not contribute as, from \textbf{Equation \ref{orthonormal_perturbation_terms}}, we know that $\braket{\psi_n^{(0)}|\psi_n^{(1)}} = 0$. Multiplying \textbf{Equation \ref{first_order_correction_eig_eqn}} on both sides by $\ket{\psi_m^{(0)}}$, we can find the coefficient $\braket{\psi_m^{(0)}|\psi_n^{(1)}}$:
\begin{equation}
    \begin{split}
        &\braket{\psi_m^{(0)}|H_0|\psi_n^{(1)}} + \braket{\psi_m^{(0)}|W|\psi_n^{(0)}} = \braket{\psi_m^{(0)}|E_n^{(0)}|\psi_n^{(1)}} + \braket{\psi_m^{(0)}|E_n^{(1)}|\psi_n^{(0)}}\\
        &\longrightarrow E_m^{(0)}\braket{\psi_m^{(0)}|\psi_n^{(1)}} + \braket{\psi_m^{(0)}|W|\psi_n^{(0)}} = E_n^{(0)}\braket{\psi_m^{(0)}|\psi_n^{(1)}} + \cancelto{\ 0}{E_n^{(1)}\braket{\psi_m^{(0)}|\psi_n^{(0)}}} \\
        &\longrightarrow \braket{\psi_m^{(0)}|W|\psi_n^{(0)}} = \left(E_n^{(0)} - E_m^{(0)}\right)\braket{\psi_m^{(0)}|\psi_n^{(1)}}
    \end{split}
\end{equation}
Therefore:
\begin{equation}
    \braket{\psi_m^{(0)}|\psi_n^{(1)}} = \frac{\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}}{E_n^{(0)} - E_m^{(0)}}
\end{equation}
And, finally:
\begin{equation}
    \ket{\psi_n^{(1)}} = \sum_{m\neq n} \frac{\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}}{E_n^{(0)} - E_m^{(0)}}\ket{\psi_m^{(0)}}
\end{equation}

Unlike the formula for the energy shift, the correction to the eigenstates involves in general an infinite sum mixing all the states of the unperturbed system. We speak of the perturbation mixing the unperturbed eigenstates.


We can now completely define the first order correction:
\begin{definition}
    The first order correction to the energy is defined as:
    \begin{equation}
        E_n^{(1)} = \braket{\psi_n^{(0)}|W|\psi_n^{(0)}}
    \end{equation}
    where $W = \lambda^{-1}H_p$, so that the total energy corrected to the first order is:
    \begin{equation}
        E_n = E_n^{(0)} + \braket{\psi_n^{(0)}|H_p|\psi_n^{(0)}}
    \end{equation}
    Furthermore, the first order correction to the eigenstate is given by:
    \begin{equation} \label{first_order_correction_ket}
        \ket{\psi_n^{(1)}} = \sum_{m\neq n} \frac{\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}}{E_n^{(0)} - E_m^{(0)}}\ket{\psi_m^{(0)}}
    \end{equation}
    where again we have $W = \lambda^{-1}H_p$, so that the total corrected eigenket is:
    \begin{equation}
        \ket{\psi_n} = \ket{\psi_n^{(0)}} + \sum_{m\neq n} \frac{\braket{\psi_m^{(0)}|H_p|\psi_n^{(0)}}}{E_n^{(0)} - E_m^{(0)}}\ket{\psi_m^{(0)}}
    \end{equation}
\end{definition}

\subsubsection{Second order correction}

If we multiply both sides of \textbf{Equation \ref{second_order_correction_eig_eqn}} by $\bra{\psi_n^{(0)}}$, we find\footnote{Remember that $H_0$ is Hermitian, so it can be applied to its eigenstate $\phi_n^{(0)}$ on the left.}:
\begin{equation}
    \begin{split}
        &\braket{\psi_n^{(0)}|H_0|\psi_n^{(2)}} + \braket{\psi_n^{(0)}|W|\psi_n^{(1)}} = \braket{\psi_n^{(0)}|E_n^{(0)}|\psi_n^{(2)}} + \braket{\psi_n^{(0)}|E_n^{(1)}|\psi_n^{(1)}} + \braket{\psi_n^{(0)}|E_n^{(2)}|\psi_n^{(0)}}\\
        &\longrightarrow \cancelto{\ 0}{E_n^{(0)}\braket{\psi_n^{(0)}|\psi_n^{(2)}}} + \braket{\psi_n^{(0)}|W|\psi_n^{(1)}} = \cancelto{\ 0}{E_n^{(0)}\braket{\psi_n^{(0)}|\psi_n^{(2)}}} + \cancelto{\ 0}{E_n^{(1)}\braket{\psi_n^{(0)}|\psi_n^{(1)}}} + E_n^{(2)}\cancelto{\ 1}{\braket{\psi_n^{(0)}|\psi_n^{(0)}}}\\
        &\longrightarrow \braket{\psi_n^{(0)}|W|\psi_n^{(1)}} = E_n^{(2)}
    \end{split}
\end{equation}
Therefore:
\begin{equation}
    E_n^{(2)} = \braket{\psi_n^{(0)}|W|\psi_n^{(1)}} 
\end{equation}

Combining this expression with \textbf{Equation \ref{first_order_correction_ket}} (and using that $W$ is Hermitian), we can obtain:
\begin{equation}
    \begin{split}
        E_n^{(2)} &= \bra{\psi_n^{(0)}}W \left(\sum_{m\neq n} \frac{\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}}{E_n^{(0)} - E_m^{(0)}}\ket{\psi_m^{(0)}}\right) = \sum_{m\neq n} \frac{\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}}{E_n^{(0)} - E_m^{(0)}}\braket{\psi_n^{(0)}|W|\psi_m^{(0)}} = \\
        &= \sum_{m\neq n} \frac{\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}}{E_n^{(0)} - E_m^{(0)}}\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}^* = \sum_{m\neq n} \frac{\left|\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}\right|^2}{E_n^{(0)} - E_m^{(0)}} \\
    \end{split}
\end{equation}
Finally, we can define:
\begin{definition}
    The second correction to the energy is given by:
    \begin{equation}
        E_n^{(2)} = \sum_{m\neq n} \frac{\left|\braket{\psi_m^{(0)}|W|\psi_n^{(0)}}\right|^2}{E_n^{(0)} - E_m^{(0)}}
    \end{equation}
    where $W = \lambda^{-1}H_p$, so that the total energy corrected to the second order is:
    \begin{equation}
        E_n = E_n^{(0)} + \braket{\psi_n^{(0)}|H_p|\psi_n^{(0)}} + \sum_{m\neq n} \frac{\left|\braket{\psi_m^{(0)}|H_p|\psi_n^{(0)}}\right|^2}{E_n^{(0)} - E_m^{(0)}}
    \end{equation}
\end{definition}

\subsection{Degenerate perturbation theory}

The method we described before is valid for cases in which the eigenenergies are non-degenerate. However, for perturbing degenerate eigenenergies and their corresponding eigenstates, we must apply a different theory\footnote{Note that, if we have only \textit{some} degenerate eigenvalues, then we apply degenerate perturbation theory only to those degenerate eigenenergies and their states, and we apply normal perturbation theory to the remaining non-degenerate eigenvalues and eigenstates.\color{red} Check}. As we will see, the effect of a perturbation on a degenerate level is to remove some or all of the degeneracy. We say that the degeneracy is \textit{lifted}. In other words, the perturbation can (it may not) split the level $E_p^{(0)}$ into distinct sublevels. 

Let us consider a $g_p$-degenerate eigenvalue, $E_p^{(0)}$, of the unperturbed Hamiltonian, $H_0$, with eigenstates $\ket{{\psi_p^i}^{(0)}}$, where $i = 1, 2, 3, \dots , g_p$ is the index identifying each of the $g_p$ degenerate states\footnote{The $i$ stands for one or more quanutm numbers that the energy is independent of.}. The eigenvalue equation for the degenerate eigenenergy is written as:
\begin{equation}
    H_0 \ket{{\psi_p^i}^{(0)}} = E_p^{(0)} \ket{{\psi_p^i}^{(0)}}
\end{equation}
The eigenstates $\ket{{\psi_p^i}^{(0)}}$ corresponding to $E_p^{(0)}$ form a degenerate $g_p$-dimensional subpace of the full state space, in which they conform a complete orthonormal basis:
\begin{equation}
    \braket{{\psi_p^i}^{(0)}|{\psi_p^j}^{(0)}} = \delta_{ij} \qquad \sum_{i=1}^{g_p} \ket{{\psi_p^i}^{(0)}}\bra{{\psi_p^i}^{(0)}} = \Imat
\end{equation}
Note that any set of $g_p$ linearly independent vectors in the degenerate subspace will conform a basis for the degenerate subspace. The choice is arbitrary until we subject the wave functions to the requirement that the change in them under the action of the applied perturbation should be small. Therefore, the zero order approximation consists in finding the correct linear combination of the initial vectors $\{\ket{{\psi_n^i}^{(0)}}\}$ such that this condition is met. For a general zero order correction of the eigenvectors of the degenerate subspace, we can write\footnote{This index-less $\ket{\psi_n^{(0)}}$ represents the \textit{general ``shape''} of the zero order correction to the eigenstates. We will later find that, as a result of our calculations, this separates into $g_p$ distinct definitions for each of the $g_p$ eigenstates of the zero correction. For now, however, it makes no sense to carry an index labeling each of those, as we cannot yet distinguish between them.}:
\begin{equation} \label{zero_order_approx_initial_def}
    \ket{\psi_n^{(0)}} = \sum_{k=1}^{g_p} a_k\ket{{\psi_p^k}^{(0)}}
\end{equation}
From this point to the end of this section, we will use the index $p$ to denote the initial eigenstates $\{\ket{{\psi_p^i}^{(0)}}\}$ corresponding to the degenerate eigenvalue $E_p^{(0)}$ that were obtained directly from solving the unperturbed system. We will use the index $n$ to denote the zero order approximation of the eigenstates $\{\ket{{\psi_n^i}^{(0)}}\}$ of the perturbed Hamiltonian, which are just a linear combination of $\{\ket{{\psi_p^i}^{(0)}}\}$. By definition, $\{\ket{{\psi_n^i}^{(0)}}\}$ are eigenstates of the unperturbed system and {\color{red}almost or complete?} eigenstates of the perturbed system.

Considering orthonormality, we can determine the following relation concerning the coefficients:
\begin{equation}
    1 = \braket{{\psi_n^k}^{(0)}|{\psi_n^k}^{(0)}} = \sum_{k=1}^{g_p} |a_k|^2
\end{equation}

Let us now rewrite the eigenvalue equation for the perturbed Hamiltonian using the expression from \textbf{Equation \ref{zero_order_approx_initial_def}} {\color{red}Why do we introduce directly $\ket{\psi_n^{(0)}}$? This is related to the above question}:
\begin{equation}
    \begin{split}
        H\ket{\psi_n^{(0)}} = E_n\ket{\psi_n^{(0)}} &\longrightarrow (H_0 + H_p)\sum_{k=1}^{g_p} a_k\ket{{\psi_p^k}^{(0)}} = E_n\sum_{k=1}^{g_p} a_k\ket{{\psi_p^k}^{(0)}} \\
        &\longrightarrow \sum_{k=1}^{g_p} a_k\left[H_0\ket{{\psi_p^k}^{(0)}} + H_p\ket{{\psi_p^k}^{(0)}}\right] = E_n\sum_{k=1}^{g_p} a_k\ket{{\psi_p^k}^{(0)}} \\ 
        &\longrightarrow \sum_{k=1}^{g_p} a_k\left[E_n^{(0)}\ket{{\psi_p^k}^{(0)}} + H_p\ket{{\psi_p^k}^{(0)}}\right] = E_n\sum_{k=1}^{g_p} a_k\ket{{\psi_p^k}^{(0)}} \\ 
    \end{split}
\end{equation}
Multiplying both sides of this equation by $\bra{{\psi_p^j}^{(0)}}$ yields:
\begin{equation}
    \begin{split}
        \sum_{k=1}^{g_p} a_k&\left[E_n^{(0)}\braket{{\psi_p^j}^{(0)}|{\psi_p^k}^{(0)}} + \braket{{\psi_p^j}^{(0)}|H_p|{\psi_p^k}^{(0)}}\right] = E_n\sum_{k=1}^{g_p} a_k\braket{{\psi_p^j}^{(0)}|{\psi_p^k}^{(0)}} \\ 
        &\longrightarrow \sum_{k=1}^{g_p} a_k\left[E_n^{(0)}\delta_{k,j} + \braket{{\psi_p^j}^{(0)}|H_p|{\psi_p^k}^{(0)}}\right] = E_n\sum_{k=1}^{g_p} a_k\delta_{k,j} \\ 
        &\longrightarrow a_jE_n^{(0)} + \sum_{k=1}^{g_p} a_k\braket{{\psi_p^j}^{(0)}|H_p|{\psi_p^k}^{(0)}} = a_j E_n \\ 
    \end{split}
\end{equation}

If we denote $H_{p_{jk}} = \braket{{\psi_p^j}^{(0)}|H_p|{\psi_p^k}^{(0)}}$ and $E_n^{(1)}=E_n - E_n^{(0)}$, we can write this as:
\begin{equation}
    \sum_{k=1}^{g_p} a_k\left(H_{p_{jk}}-\delta_{k,j} E_n^{(1)}\right) = 0
\end{equation}

which, considering $j = 1, 2, 3, \dots, g_p$, gives a system of $g_p$ linear equations for the coefficients $a_k$. These coefficients are non-vanishing only when the determinant $|H_{p_{jk}}-\delta_{k,j} E_n^{(1)}|$ is zero:
\begin{equation}
    \left|\ \begin{matrix}
        H_{p_{11}} - E_n^{(1)} & H_{p_{12}} & \cdots & H_{p_{1g_p}} \\
        H_{p_{21}} & H_{p_{22}}- E_n^{(1)} & \cdots & H_{p_{2g_p}} \\
        \vdots & \vdots & \ddots & \vdots \\
        H_{p_{g_p1}} & H_{p_{g_p2}} & \cdots & H_{p_{g_pg_p}}- E_n^{(1)} \\
    \end{matrix}\ \right| = 0
\end{equation}

This determinant is a $g_p$-th degree equation in $E_n^{(1)}$, which in general has $g_p$ different roots ${E_n^i}^{(1)}$ (some may not be different), each of which is the first order correction to the energy corresponding to the $i$-th eigenvector of the degenerate eigenvalue $E_n^{(0)}$ of the unperturbed system. Similarly to when we find the characteristic polynomial $P(\lambda)$ of a matrix $A$ and solve $P(\lambda)=0$ to find the eigenvectors, once we have the first order corrections of the energy we substitute the different values into the system of equations:
\begin{equation}
    \begin{bmatrix}
        H_{p_{11}} - {E_n^i}^{(1)} & H_{p_{12}} & \cdots & H_{p_{1g_p}} \\
        H_{p_{21}} & H_{p_{22}}- {E_n^i}^{(1)} & \cdots & H_{p_{2g_p}} \\
        \vdots & \vdots & \ddots & \vdots \\
        H_{p_{g_p1}} & H_{p_{g_p2}} & \cdots & H_{p_{g_pg_p}}- {E_n^i}^{(1)} \\
    \end{bmatrix}\cdot \begin{bmatrix}
        a_1^i \\ a_2^i \\ \vdots \\ a_{g_p}^i 
    \end{bmatrix} = \begin{bmatrix}
        0 \\ 0 \\ \vdots \\ 0 
    \end{bmatrix}
\end{equation}
To find the coefficients $a_k$. The $i$-th root ${E_n^i}^{(1)}$ allows us to find the coefficients $a_k^i$ for the zero order correction of the eigenstate $\ket{{\psi_n^i}^{(0)}}$, such that:
\begin{equation}
    \ket{{\psi_n^i}^{(0)}} = \sum_{k=1}^{g_p} a_k^i\ket{{\psi_p^k}^{(0)}}, \qquad i = 1, 2, 3, \dots, g_p
\end{equation}
In general, the roots ${E_n^i}^{(0)}$ are different, so the $g_p$-degenerate level $E_n^{(0)}$ is split into $g_p$ different levels $E_n^i = E_n^{(0)} + {E_n^i}^{(1)}$. In this way, the perturbation lifts the degeneracy, depending on whether all the roots or only some of them are different.

In summary, the degenerate perturbation method consists of the following steps:
\begin{enumerate}
    \item For each of the $g_p$-fold degenerate levels, determine the $g_p\times g_p$ matrix of the perturbation $H_p$:
    \begin{equation}
        H_p = \begin{pmatrix}
        H_{p_{11}} & H_{p_{12}} & \cdots & H_{p_{1g_p}} \\
        H_{p_{21}} & H_{p_{22}} & \cdots & H_{p_{2g_p}} \\
        \vdots & \vdots & \ddots & \vdots \\
        H_{p_{g_p1}} & H_{p_{g_p2}} & \cdots & H_{p_{g_pg_p}} \\
        \end{pmatrix}
    \end{equation}
    where $H_{p_{jk}} = \braket{{\psi_p^j}^{(0)}|H_p|{\psi_p^k}^{(0)}}$.
    \item Diagonalize this matrix and find the $g_p$ eigenvalues ${E_n^i}^{(1)}$ ($i = 1, 2, 3, \dots, g_p$) and their corresponding eigenvectors:
    \begin{equation}
        \vec{a}\,^i = \begin{pmatrix}
            a_1^i \\ a_2^i \\ \vdots \\ a_{g_p}^i 
        \end{pmatrix},\qquad (i = 1, 2, 3, \dots, g_p)
    \end{equation} 
    \item Finally, the first order corrections to the energy for the $g_p$ eigenstates corresponding to the original degenerate level are given by:
    \begin{equation}
        E_n^i = E_n^{(0)} + {E_n^i}^{(1)},\qquad (i = 1, 2, 3, \dots, g_p)
    \end{equation}
    And the corresponding eigenvectors are given to order zero as:
    \begin{equation}
        \ket{{\psi_n^i}^{(0)}} = \sum_{k=1}^{g_p} a_k^i\ket{{\psi_p^k}^{(0)}}, \qquad i = 1, 2, 3, \dots, g_p
    \end{equation}
\end{enumerate}

Just as for non-degenerate levels, the method described in this section is valid only if the matrix elements of the perturbation are much smaller than the differences between the energy of the level under study and those of the other levels (this conclusion would have been evident if we had calculated higher-order corrections).

\subsubsection{The Stark effect}

The Stark effect is an example where degenerate perturbation can be applied to solve a quantum mechanical problem. It is related to the interaction of the electric dipole of the hydrogen atom with an external electric field.

In the absence of an external magnetic field, the first excited state of the hydrogen atom, $n=2$, is fourfold degenerate: the states $\ket{n,l,m} = \ket{200}, \ket{210}, \ket{211}, \ket{21-1}$ have the same energy $E_2 = -R_y/4$, where $R_y = \mu e^4 / (2\hbar^2) = 13.6 eV$ is the Rydberg constant. 

Consider now a hydrogen atom placed in a uniform static electric field $\vec{\mathcal{E}}$ parallel to the $z$ axis. To the Hamiltonian of the Hydrogen atom, we must add the Stark Hamiltonian $W_S$, which describes the interaction energy of the electric dipole of the atom $\vec{d} = -e\vec{r}$ with the electric field $\vec{\mathcal{E}} = \mathcal{E}\vec{e}_z$. We can write $W_S$ as:
\begin{equation}
    W_S = -\vec{d}\cdot \vec{\mathcal{E}} = e\vec{r}\cdot \vec{\mathcal{E}} = e\mathcal{E}Z
\end{equation}

To calculate the first order correction to the energies, we need to determine and then diagonalise the $4\times 4$ matrix elements $W_{s_{l'm'lm}} = \braket{2l'm'|W_s|2lm}$. For calculating the matrix elements\footnote{We use that $z = r\cos\theta$.}: 
\begin{equation}
    \begin{split}
        \braket{2l'm'|W_s|2lm} &= e\mathcal{E} \braket{2l'm'|Z|2lm} = \\
        &= e\mathcal{E} \int_{0}^{\infty}dr\int_{0}^{\pi}d\theta\int_{0}^{2\pi}d\phi \cdot r^2\sin\theta \cdot \left[\psi_{l',m'}(r,\theta,\phi)\right]^*\cdot r\cos\theta \cdot\psi_{l,m}(r,\theta,\phi) = \\
        &= e\mathcal{E} \int_{0}^{\infty}dr\cdot r^3\int_{0}^{\pi}d\theta\cdot \sin\theta\cos\theta\int_{0}^{2\pi}d\phi \cdot \left[\psi_{l',m'}(r,\theta,\phi)\right]^*\cdot \psi_{l,m}(r,\theta,\phi)
    \end{split}
\end{equation}
Using that $\psi_{l,m}(r,\theta,\phi) = R_l(r)Y_l^m(\theta, \phi)$, we obtain:
\begin{equation}
    \begin{split}
        \braket{2l'm'|W_s|2lm} &= e\mathcal{E} \int_{0}^{\infty}dr\cdot r^3\int_{0}^{\pi}d\theta\cdot \sin\theta\cos\theta\int_{0}^{2\pi}d\phi \cdot \left[R_{l'}(r)Y_{l'}^{m'}(\theta, \phi)\right]^*\cdot R_l(r)Y_l^m(\theta, \phi) = \\
        &= e\mathcal{E} \int_{0}^{\infty}dr\cdot r^3\, R_{l'}^*(r)R_l(r)\int_{0}^{\pi}d\theta\cdot \sin\theta\cos\theta\int_{0}^{2\pi}d\phi \left[Y_{l'}^{m'}(\theta, \phi)\right]^*\, Y_l^m(\theta, \phi) \\
    \end{split}
\end{equation}

From here, we can easily see that the only non-zero matrix elements are those for which $m' = m$\footnote{Clarify this, which is stated in Zetilli.}. Therefore, the only non-vanishing matrix elements will be those between any combination of the states $\ket{200}$ and $\ket{210}$. Furthermore, taking into account the parity of spherical harmonics, from \textbf{Equation \ref{parity_spherical_harmonics}}, and the fact that the operator $Z$ is odd, we can see that the only non-zero matrix elements are those for which $l' = l\pm 1$. Therefore, the only matrix element that does not vanish (its complex conjugate matrix element does not vanish either, of course), is:
\begin{equation}
    \begin{split}
        \braket{200|W_s|210} &= e\mathcal{E} \int_{0}^{\infty}dr\cdot r^3\, R_0^*(r)R_1(r)\int_{0}^{\pi}d\theta\cdot \sin\theta\cos\theta\int_{0}^{2\pi}d\phi \left[Y_0^0(\theta, \phi)\right]^*\, Y_1^0(\theta, \phi) = -3e\mathcal{E}a_0\\
    \end{split}
\end{equation}

where $a_0 = \frac{\hbar^2}{\mu e^2}$ is the Bohr radius. Therefore, the matrix of the perturbation is:

\begin{equation}
    W_s = -3e\mathcal{E}a_0\begin{pmatrix}
        0 & 1 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}
\end{equation}

Diagonalizing this matrix leads to the following eigenvalues:
\begin{equation}
    {E_2^1}^{(1)} = -3e\mathcal{E}a_0,\qquad {E_2^2}^{(1)} = {E_2^3}^{(1)} = 0, \qquad {E_2^4}^{(1)} = 3e\mathcal{E}a_0
\end{equation}

The corrections eigenvectors to the zeroth order are:
\begin{equation}
    \begin{split}
        \ket{{\psi_2^1}^{(0)}} = \frac{1}{\sqrt{2}} \left(\ket{200} + \ket{210}\right), \qquad \ket{{\psi_2^2}^{(0)}} = \ket{211},\\
        \ket{{\psi_2^3}^{(0)}} = \ket{21-1}, \qquad \ket{{\psi_2^4}^{(0)}} = \frac{1}{\sqrt{2}} \left(\ket{200} - \ket{210}\right),\\
    \end{split}
\end{equation}

As we can see, this perturbation has only partially removed the degeneracy of the $n= 2$ level; the states $\ket{211}$ and $\ket{21-1}$ still have the same energy.

\subsection{The variational method}

The variational method is used for finding approximate solutions to problems that cannot be solved exactly. It is based upon the fact that the energy of any trial wave function $\psi_T$ is an upper bound to the true ground state energy of the system. The variational method consists in choosing a trial wave function $\psi_T$ that depends on one or more parameters, and then minimizing the expectation value of the energy with respect to these parameters. The minimum value of the energy is an upper bound to the true ground state energy of the system. The closer the trial wave function is to the true ground state wave function, the closer the upper bound is to the true ground state energy.

Consider a system described by a Hamiltonian $H$, with a complete set of eigenstates $\{\ket{n}\}$ and corresponding eigenvalues $\{E_n\}$ ordered in increasing value:
\begin{equation}
    E_1 < E_2 < E_3 < \dots
\end{equation}
An arbitrary state $\ket{n}$ can be expanded as a linear superposition
\begin{equation}
    \ket{\psi} = \sum_n c_n\ket{n},\text{ with }c_n = \braket{n|\psi}
\end{equation}
Then, we can compute the expectation value of the energy as:
\begin{equation}
    \braket{E} = \frac{\braket{\psi|H|\psi}}{\braket{\psi|\psi}} = \frac{\sum_n |c_n|^2 E_n }{\sum_n |c_n|^2} \geq \frac{\sum_n |c_n|^2 E_1 }{\sum_n |c_n|^2} = E_1
\end{equation}
where we have used the fact that $E_n \geq E_1$ for $n>1$. Therefore, the expectation value of the energy for any state is an upper bound to the ground state energy $E_1$. This is the basis of the variational method, which gives way to the following procedure:
\begin{enumerate}
    \item Choose a trial state $\ket{\psi_T}$ that depends on one or more parameters $\alpha_1, \alpha_2, \cdots, \alpha_r$.
    \item Compute:
    \begin{equation}
        E (\alpha_1, \alpha_2, \cdots, \alpha_r) = \frac{\braket{\psi_T|H|\psi_T}}{\braket{\psi_T|\psi_T}}
    \end{equation}
    \item Minimize $E (\alpha_1, \alpha_2, \cdots, \alpha_r)$ with respect to the variational parameters $\alpha_1, \alpha_2, \cdots, \alpha_r$ by solving the equations:
    \begin{equation}
        \frac{\partial E}{\partial \alpha_i} = 0, \qquad i = 1, 2, \cdots, r
    \end{equation}
    \item Evaluate the averge energy of the system using the values of the variational parameters that minimize $E (\alpha_1, \alpha_2, \cdots, \alpha_r)$.
    \item The minimum value of the energy that we obtain is an upper bound to the true ground state energy of the system.
\end{enumerate}

A good trial function incorporates as many of the features of the exact wavefunction as possible, some of which can be deduced from symmetry arguments. Note that the variational method is aimed at optimising the estimate of the \textit{energy} of the energy. It may not necessarily give a good approximation to the true \textit{wave function}, and could give poor results if used to calculate things other than the energy.


% Dw = 4pi/t -> Heisenberg time-energy uncertainty principle